package com.hhhh.group.secwealth.mktdata.api.equity.topmover.service;


import com.hhhh.group.secwealth.mktdata.api.equity.ServerLauncher;
import com.hhhh.group.secwealth.mktdata.api.equity.common.bean.response.ProdAltNumSeg;
import com.hhhh.group.secwealth.mktdata.api.equity.common.component.predsrch.PredSrchService;
import com.hhhh.group.secwealth.mktdata.api.equity.common.component.predsrch.request.PredSrchRequest;
import com.hhhh.group.secwealth.mktdata.api.equity.common.component.predsrch.response.PredSrchResponse;
import com.hhhh.group.secwealth.mktdata.api.equity.common.properties.EtnetProperties;
import com.hhhh.group.secwealth.mktdata.api.equity.common.properties.LabciProperties;
import com.hhhh.group.secwealth.mktdata.api.equity.topmover.request.TopMoverRequest;
import com.hhhh.group.secwealth.mktdata.api.equity.topmover.response.TopMoverLabciResponse;
import com.hhhh.group.secwealth.mktdata.api.equity.topmover.response.TopMoverLabciTable;
import com.hhhh.group.secwealth.mktdata.starter.cache_distribute_handler.bean.CacheDistributeResponse;
import com.hhhh.group.secwealth.mktdata.starter.cache_distribute_handler.utils.CacheDistributeHolder;
import com.hhhh.group.secwealth.mktdata.starter.http_client_manager.component.HttpClientHelper;
import com.hhhh.group.secwealth.mktdata.wmds_prototype.header.CommonRequestHeader;
import org.junit.Before;
import org.junit.Test;
import org.junit.runner.RunWith;
import org.mockito.InjectMocks;
import org.mockito.Mock;
import org.mockito.MockitoAnnotations;
import org.mockito.runners.MockitoJUnitRunner;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.beans.factory.annotation.Qualifier;
import org.springframework.boot.test.context.SpringBootTest;
import org.springframework.test.context.ActiveProfiles;
import org.springframework.test.context.junit4.SpringJUnit4ClassRunner;

import java.util.ArrayList;
import java.util.HashMap;
import java.util.List;
import java.util.Map;
import java.util.concurrent.CompletableFuture;

import static org.junit.Assert.assertEquals;
import static org.junit.Assert.assertNotNull;
import static org.mockito.Matchers.any;
import static org.mockito.Mockito.doNothing;
import static org.mockito.Mockito.when;

@RunWith(MockitoJUnitRunner.class)
@ActiveProfiles({"sit_hase_stma_eqty_unittest","test"})
public class TopMoverMidfsServiceTest {

    @InjectMocks
    @Autowired
    private TopMoverMidfsService topMoverMidfsService;

    private TopMoverRequest topMoverRequest;

    private CommonRequestHeader commonRequestHeader;

    private CacheDistributeResponse response;

    @Mock
    private PredSrchService predSrchService;

    @Mock
    private HttpClientHelper httpClientHelper;

    @Mock
    private QuoteAccessLogService quoteAccessLogService;

    @Mock
    private EtnetProperties etnetProperties;

    @Mock
    private LabciProperties labciProps;

    @Mock()
    private QuoteUserService quoteUserService;

    @Before
    public void init() throws Exception {
        MockitoAnnotations.initMocks(this);
        when(etnetProperties.getEtnetTokenWithoutVerify()).thenReturn("be984b45f46ba4f3cb43f009672a583b1605a621b33f4358967a1bf06539030c");
        topMoverRequest = new TopMoverRequest();
        topMoverRequest.setMarket("HK");
        topMoverRequest.setExchangeCode("SHAS");
        topMoverRequest.setDelay(true);
        topMoverRequest.setProductType("SEC");
        topMoverRequest.setTopNum(3);
        topMoverRequest.setCountryCode("HK");
        topMoverRequest.setGroupMember("0005");
        topMoverRequest.setAppCode("STMA");
        topMoverRequest.setRequestType("0");
        topMoverRequest.setBoardType("MAIN");
        topMoverRequest.setMoverType("VOL");


        commonRequestHeader = new CommonRequestHeader();
        commonRequestHeader.setCountryCode("HK");
        commonRequestHeader.setGroupMember("HASE");
        commonRequestHeader.setChannelId("OHI");
        commonRequestHeader.setLocale("en");
        commonRequestHeader.setAppCode("STMA");
        commonRequestHeader.setSaml3String("<saml:Assertion xmlns:saml='http://www.hhhh.com/saas/assertion' xmlns:ds='http://www.w3.org/2000/09/xmldsig#' xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' ID='id_f05dfba8-f54f-4bb2-8b09-8841eed507a9' IssueInstant='2018-09-13T06:34:32.938Z' Version='3.0'><saml:Issuer>https://www.hhhh.com/rbwm/dtp</saml:Issuer><ds:Signature><ds:SignedInfo><ds:CanonicalizationMethod Algorithm='http://www.w3.org/2001/10/xml-exc-c14n#'/><ds:SignatureMethod Algorithm='http://www.w3.org/2001/04/xmldsig-more#rsa-sha256'/><ds:Reference URI='#id_f05dfba8-f54f-4bb2-8b09-8841eed507a9'><ds:Transforms><ds:Transform Algorithm='http://www.w3.org/2000/09/xmldsig#enveloped-signature'/><ds:Transform Algorithm='http://www.w3.org/2001/10/xml-exc-c14n#'><ds:InclusiveNamespaces xmlns:ds='http://www.w3.org/2001/10/xml-exc-c14n#' PrefixList='#default saml ds xs xsi'/></ds:Transform></ds:Transforms><ds:DigestMethod Algorithm='http://www.w3.org/2001/04/xmlenc#sha256'/><ds:DigestValue>MTorXOJZywI0rGxRejeh25NnHd597uZ6vjl1+zb4AY8=</ds:DigestValue></ds:Reference></ds:SignedInfo><ds:SignatureValue>BUCrrR+kHl4WEXRQga7kMlNjFF4/u/qsTXtwetexIvE4TtMnnjSF6XlgmLvbwpqI2xz0bUmanNqVWJnIcaU2gzbHCgI/hypX4XtQTuEKYEn87ZvNwAaeZmpLb361GPeghZC7/TIQBHvRpbbe2MKR3Y3gk2R1KIYCEEdmf3MaxsB/35E8Yf2bqlHo3GKpClPebnNqa1eQmrmnzZKpOFgR4nv+bHRc/cB7GNwcaOdEUQwq3IyimVOfG0v+lWBQzaJ9sQmuhQKZoI/Dp2yGovYz9DFBQZt9Q1bCIKn9kPTtrQnqF3yd3mRTPjxK/ZawyzhVomQmbDuDwExGMf/fdFgd6g==</ds:SignatureValue></ds:Signature><saml:Subject><saml:NameID>80f19b7022b611e8bb8b006136</saml:NameID></saml:Subject><saml:Conditions NotBefore='2018-09-13T06:34:31.938Z' NotOnOrAfter='2018-09-13T06:35:32.938Z'/><saml:AttributeStatement><saml:Attribute Name='GUID'><saml:AttributeValue>80f19b70-22b6-11e8-bb8b-000006010306</saml:AttributeValue></saml:Attribute><saml:Attribute Name='CAM'><saml:AttributeValue>30</saml:AttributeValue></saml:Attribute></saml:AttributeStatement></saml:Assertion>");
        commonRequestHeader.setFunctionId("01");

        response = new CacheDistributeResponse();
        response.setCacheExistingFlag("Y");
        response.setKey("eID");
        response.setValue("{\"eID\":\"001\",\"stsCode\":\"0\",\"stsTxt\":\"OK\",\"result\":[{\"item\":\".CSI300\",\"stsCode\":\"0\",\"displayName\":\"hhhh HOLDINGS\",\"child\":[{ \"_item\":\"001\", \"MNEMONIC\":\"CSI300\", \"DSPLY_NAME\":\"大喜屋集團\",\"TRDPRC_1\":8.95,\"NETCHNG_1\":11.88,\"PCTCHNG\":-0.83,\"CURRENCY\":\"HKD\",\"TRADE_DATE\":\"2020-03-23\",\"TRDTIM_1\":\"02:15:00.000Z\"}],\"timeZone\":{ \"gmtOffset\":1, \"shortName\":\"11111\", \"summerEnd\":\"2222\",\"summerOffset\":3,\"summerStart\":\"3333\" },\"field\":[\"DATE\",\"OPEN\",\"HIGH\",\"LOW\",\"CLOSE\",\"VOLUME\"],\"data\":[[\"2021-07-23T01:30:00.000Z\",5145.379,5145.379,5120.148,5124.342,16698],[\"2021-07-23T01:35:00.000Z\",5124.530,5128.960,5109.777,5110.258,12318],[\"2021-07-23T01:40:00.000Z\",5110.111,5115.073,5103.866,5107.004,9717],[\"2021-07-23T01:45:00.000Z\",5106.603,5108.750,5097.142,5108.750,8726],[\"2021-07-23T01:50:00.000Z\",5108.566,5114.193,5108.566,5111.264,7603],[\"2021-07-23T01:55:00.000Z\",5111.370,5112.570,5102.432,5108.410,6672],[\"2021-07-23T02:00:00.000Z\",5108.942,5109.706,5103.054,5109.706,6786],[\"2021-07-23T02:05:00.000Z\",5110.464,5116.648,5109.316,5109.316,5282],[\"2021-07-23T02:10:00.000Z\",5108.982,5108.982,5105.335,5106.516,5189],[\"2021-07-23T02:15:00.000Z\",5106.144,5106.531,5098.227,5098.301,4369],[\"2021-07-23T02:20:00.000Z\",5097.991,5099.235,5094.829,5098.616,4348],[\"2021-07-23T02:25:00.000Z\",5098.387,5098.404,5088.941,5089.400,4339],[\"2021-07-23T02:30:00.000Z\",5089.205,5100.817,5087.743,5099.676,5151],[\"2021-07-23T02:35:00.000Z\",5099.623,5101.889,5095.609,5095.609,4792],[\"2021-07-23T02:40:00.000Z\",5095.365,5096.498,5093.116,5096.498,4023],[\"2021-07-23T02:45:00.000Z\",5096.379,5097.732,5092.887,5097.732,3919],[\"2021-07-23T02:50:00.000Z\",5098.295,5109.343,5098.295,5104.478,2980],[\"2021-07-23T02:55:00.000Z\",5104.289,5107.907,5103.106,5105.517,3291],[\"2021-07-23T03:00:00.000Z\",5105.026,5120.397,5102.700,5120.397,4486],[\"2021-07-23T03:05:00.000Z\",5121.900,5122.886,5115.930,5116.283,5423]]}]}");
        CompletableFuture<CacheDistributeResponse> future = new CompletableFuture<>();
        future.complete(response);
        CacheDistributeHolder.putCacheDistribute(future);

        PredSrchResponse predSrchResponse = new PredSrchResponse();
        predSrchResponse.setProductType("SEC");
        predSrchResponse.setCountryTradableCode("US");
        predSrchResponse.setProductName("ARK INNOVATION ETF");
        predSrchResponse.setProductShortName("ARK INNOVATION ETF");
        predSrchResponse.setSymbol("ARKK");
        //predSrchResponse.setProductCode("2");
        predSrchResponse.setProductCcy("USD");
        predSrchResponse.setMarket("US");
        predSrchResponse.setExchange("NYSE Arca");
        List<ProdAltNumSeg> prodAltNumSegs = new ArrayList<>();
        ProdAltNumSeg prodAltNumSeg1 = new ProdAltNumSeg();
        prodAltNumSeg1.setProdAltNum("ARKK");
        prodAltNumSeg1.setProdCdeAltClassCde("M");
        ProdAltNumSeg prodAltNumSeg2 = new ProdAltNumSeg();
        prodAltNumSeg2.setProdAltNum("ARKK.NB");
        prodAltNumSeg2.setProdCdeAltClassCde("T");
        prodAltNumSegs.add(prodAltNumSeg1);
        prodAltNumSegs.add(prodAltNumSeg2);

        predSrchResponse.setProdAltNumSegs(prodAltNumSegs);

        ArrayList<PredSrchResponse> predSrchResponses = new ArrayList<>();
        predSrchResponses.add(predSrchResponse);
        when(predSrchService.precSrch(any(PredSrchRequest.class), any(CommonRequestHeader.class))).thenReturn(predSrchResponses);
        when(predSrchService.localPredSrch(any(String.class),any(String.class))).thenReturn(predSrchResponse);
        String httpResult = "{\"moverType\":\"VOL\",\"err_code\":\"2\",\"boardType\":\"MAIN\",\"stockList\":[{\"symbol\":\"1398\",\"name\":\"ICBC\"},{\"symbol\":\"939\",\"name\":\"CCB\"},{\"symbol\":\"3988\",\"name\":\"BANK OF CHINA\"},{\"symbol\":\"2800\",\"name\":\"TRACKER FUND\"},{\"symbol\":\"857\",\"name\":\"PETROCHINA\"},{\"symbol\":\"1091\",\"name\":\"SOUTH MANGANESE\"},{\"symbol\":\"728\",\"name\":\"CHINA TELECOM\"},{\"symbol\":\"8133\",\"name\":\"JETE POWER\"},{\"symbol\":\"1288\",\"name\":\"ABC\"},{\"symbol\":\"762\",\"name\":\"CHINA UNICOM\"}],\"asOfDateTime\":\"2021-08-17T16:42:00.000+0800\"}";
        when(httpClientHelper.doGet(any(String.class),any(String.class),any(String.class),any(HashMap.class))).thenReturn(httpResult);

        String httpResult2 = "{\"moverType\":\"VOL\",\"boardType\":\"MAIN\",\"stockList\":[{\"symbol\":\"1398\",\"name\":\"ICBC\"},{\"symbol\":\"939\",\"name\":\"CCB\"},{\"symbol\":\"3988\",\"name\":\"BANK OF CHINA\"},{\"symbol\":\"2800\",\"name\":\"TRACKER FUND\"},{\"symbol\":\"857\",\"name\":\"PETROCHINA\"},{\"symbol\":\"1091\",\"name\":\"SOUTH MANGANESE\"},{\"symbol\":\"728\",\"name\":\"CHINA TELECOM\"},{\"symbol\":\"8133\",\"name\":\"JETE POWER\"},{\"symbol\":\"1288\",\"name\":\"ABC\"},{\"symbol\":\"762\",\"name\":\"CHINA UNICOM\"}],\"asOfDateTime\":\"2021-08-17T16:42:00.000+0800\"}";
        when(httpClientHelper.doGet(any(String.class),any(String.class),any(ArrayList.class),any(HashMap.class))).thenReturn(httpResult2);

        String httpResult3 = "{\"responseCode\":\"00\",\"priceQuotes\":[{\"symbol\":\"01398\",\"companyNameEN\":\"ICBC\",\"companyNameTC\":\"工商銀行\",\"companyNameSC\":\"工商银行\",\"suspendedIndicator\":\"false\",\"sessionType\":\" \",\"nominalPrice\":\"4.4000000\",\"currency\":\"HKD\",\"changeAmount\":\"-0.0200000\",\"changePercent\":\"-0.4520\",\"dayHighPrice\":\"4.4300000\",\"dayLowPrice\":\"4.3800000\",\"spreadCode\":\"01\",\"preClosePrice\":\"4.4200000\",\"openPrice\":\"4.4200000\",\"volume\":\"230133072\",\"turnover\":\"1012405388.0000\",\"boardLotSize\":\"1000\",\"vcmEligible\":\"Y\",\"vcmStatus\":\"N\",\"vcmStarttime\":\"\",\"vcmEndtime\":\"\",\"vcmRefPrice\":\"\",\"vcmUpperLimitPrice\":\"\",\"vcmLowerLimitPrice\":\"\",\"casEligible\":\"Y\",\"casReferencePrice\":\"4.4100000\",\"casUpperLimitPrice\":\"4.6300000\",\"casLowerLimitPrice\":\"4.1900000\",\"asOfDateTime\":\"2021-08-17T16:08:04+0800\",\"posEligible\":\"Y\",\"posReferencePrice\":\"\",\"posBuyUpperPrice\":\"\",\"posBuyLowerPrice\":\"\",\"posSellUpperPrice\":\"\",\"posSellLowerPrice\":\"\",\"auctionType\":\" \",\"delay\":true},{\"symbol\":\"00939\",\"companyNameEN\":\"CCB\",\"companyNameTC\":\"建設銀行\",\"companyNameSC\":\"建设银行\",\"suspendedIndicator\":\"false\",\"sessionType\":\" \",\"nominalPrice\":\"5.4300000\",\"currency\":\"HKD\",\"changeAmount\":\"-0.0300000\",\"changePercent\":\"-0.5490\",\"dayHighPrice\":\"5.4700000\",\"dayLowPrice\":\"5.3800000\",\"spreadCode\":\"01\",\"preClosePrice\":\"5.4600000\",\"openPrice\":\"5.4600000\",\"volume\":\"300197197\",\"turnover\":\"1629160256.0000\",\"boardLotSize\":\"1000\",\"vcmEligible\":\"Y\",\"vcmStatus\":\"N\",\"vcmStarttime\":\"\",\"vcmEndtime\":\"\",\"vcmRefPrice\":\"\",\"vcmUpperLimitPrice\":\"\",\"vcmLowerLimitPrice\":\"\",\"casEligible\":\"Y\",\"casReferencePrice\":\"5.4200000\",\"casUpperLimitPrice\":\"5.6900000\",\"casLowerLimitPrice\":\"5.1500000\",\"asOfDateTime\":\"2021-08-17T16:08:03+0800\",\"posEligible\":\"Y\",\"posReferencePrice\":\"\",\"posBuyUpperPrice\":\"\",\"posBuyLowerPrice\":\"\",\"posSellUpperPrice\":\"\",\"posSellLowerPrice\":\"\",\"auctionType\":\" \",\"delay\":true},{\"symbol\":\"03988\",\"companyNameEN\":\"BANK OF CHINA\",\"companyNameTC\":\"中國銀行\",\"companyNameSC\":\"中国银行\",\"suspendedIndicator\":\"false\",\"sessionType\":\" \",\"nominalPrice\":\"2.7100000\",\"currency\":\"HKD\",\"changeAmount\":\"0.0000000\",\"changePercent\":\"0.0000\",\"dayHighPrice\":\"2.7200000\",\"dayLowPrice\":\"2.6900000\",\"spreadCode\":\"01\",\"preClosePrice\":\"2.7100000\",\"openPrice\":\"2.7100000\",\"volume\":\"232339719\",\"turnover\":\"628220483.0000\",\"boardLotSize\":\"1000\",\"vcmEligible\":\"Y\",\"vcmStatus\":\"N\",\"vcmStarttime\":\"\",\"vcmEndtime\":\"\",\"vcmRefPrice\":\"\",\"vcmUpperLimitPrice\":\"\",\"vcmLowerLimitPrice\":\"\",\"casEligible\":\"Y\",\"casReferencePrice\":\"2.7100000\",\"casUpperLimitPrice\":\"2.8400000\",\"casLowerLimitPrice\":\"2.5800000\",\"asOfDateTime\":\"2021-08-17T16:08:06+0800\",\"posEligible\":\"Y\",\"posReferencePrice\":\"\",\"posBuyUpperPrice\":\"\",\"posBuyLowerPrice\":\"\",\"posSellUpperPrice\":\"\",\"posSellLowerPrice\":\"\",\"auctionType\":\" \",\"delay\":true},{\"symbol\":\"02800\",\"companyNameEN\":\"TRACKER FUND\",\"companyNameTC\":\"盈富基金\",\"companyNameSC\":\"盈富基金\",\"suspendedIndicator\":\"false\",\"sessionType\":\" \",\"nominalPrice\":\"26.7000000\",\"currency\":\"HKD\",\"changeAmount\":\"-1.1600000\",\"changePercent\":\"-4.1640\",\"dayHighPrice\":\"27.5000000\",\"dayLowPrice\":\"26.7000000\",\"spreadCode\":\"05\",\"preClosePrice\":\"27.8600000\",\"openPrice\":\"27.5000000\",\"volume\":\"304025928\",\"turnover\":\"8216446664.0000\",\"boardLotSize\":\"500\",\"vcmEligible\":\"N\",\"vcmStatus\":\"\",\"vcmStarttime\":\"\",\"vcmEndtime\":\"\",\"vcmRefPrice\":\"\",\"vcmUpperLimitPrice\":\"\",\"vcmLowerLimitPrice\":\"\",\"casEligible\":\"Y\",\"casReferencePrice\":\"26.7600000\",\"casUpperLimitPrice\":\"27.8600000\",\"casLowerLimitPrice\":\"26.6800000\",\"asOfDateTime\":\"2021-08-17T16:08:06+0800\",\"posEligible\":\"Y\",\"posReferencePrice\":\"\",\"posBuyUpperPrice\":\"\",\"posBuyLowerPrice\":\"\",\"posSellUpperPrice\":\"\",\"posSellLowerPrice\":\"\",\"auctionType\":\" \",\"delay\":true},{\"symbol\":\"00857\",\"companyNameEN\":\"PETROCHINA\",\"companyNameTC\":\"中國石油股份\",\"companyNameSC\":\"中国石油股份\",\"suspendedIndicator\":\"false\",\"sessionType\":\" \",\"nominalPrice\":\"3.2200000\",\"currency\":\"HKD\",\"changeAmount\":\"-0.0700000\",\"changePercent\":\"-2.1280\",\"dayHighPrice\":\"3.2800000\",\"dayLowPrice\":\"3.2100000\",\"spreadCode\":\"01\",\"preClosePrice\":\"3.2900000\",\"openPrice\":\"3.2700000\",\"volume\":\"100239506\",\"turnover\":\"324780909.0000\",\"boardLotSize\":\"2000\",\"vcmEligible\":\"Y\",\"vcmStatus\":\"N\",\"vcmStarttime\":\"\",\"vcmEndtime\":\"\",\"vcmRefPrice\":\"\",\"vcmUpperLimitPrice\":\"\",\"vcmLowerLimitPrice\":\"\",\"casEligible\":\"Y\",\"casReferencePrice\":\"3.2200000\",\"casUpperLimitPrice\":\"3.3800000\",\"casLowerLimitPrice\":\"3.0600000\",\"asOfDateTime\":\"2021-08-17T16:08:07+0800\",\"posEligible\":\"Y\",\"posReferencePrice\":\"\",\"posBuyUpperPrice\":\"\",\"posBuyLowerPrice\":\"\",\"posSellUpperPrice\":\"\",\"posSellLowerPrice\":\"\",\"auctionType\":\" \",\"delay\":true},{\"symbol\":\"01091\",\"companyNameEN\":\"SOUTH MANGANESE\",\"companyNameTC\":\"南方錳業\",\"companyNameSC\":\"南方锰业\",\"suspendedIndicator\":\"false\",\"sessionType\":\" \",\"nominalPrice\":\"1.0900000\",\"currency\":\"HKD\",\"changeAmount\":\"0.2400000\",\"changePercent\":\"28.2350\",\"dayHighPrice\":\"1.1300000\",\"dayLowPrice\":\"0.9000000\",\"spreadCode\":\"01\",\"preClosePrice\":\"0.8500000\",\"openPrice\":\"0.9000000\",\"volume\":\"231186559\",\"turnover\":\"240808084.0000\",\"boardLotSize\":\"1000\",\"vcmEligible\":\"N\",\"vcmStatus\":\"\",\"vcmStarttime\":\"\",\"vcmEndtime\":\"\",\"vcmRefPrice\":\"\",\"vcmUpperLimitPrice\":\"\",\"vcmLowerLimitPrice\":\"\",\"casEligible\":\"Y\",\"casReferencePrice\":\"1.0900000\",\"casUpperLimitPrice\":\"1.1200000\",\"casLowerLimitPrice\":\"1.0400000\",\"asOfDateTime\":\"2021-08-17T16:08:06+0800\",\"posEligible\":\"Y\",\"posReferencePrice\":\"\",\"posBuyUpperPrice\":\"\",\"posBuyLowerPrice\":\"\",\"posSellUpperPrice\":\"\",\"posSellLowerPrice\":\"\",\"auctionType\":\" \",\"delay\":true},{\"symbol\":\"00728\",\"companyNameEN\":\"CHINA TELECOM\",\"companyNameTC\":\"中國電信\",\"companyNameSC\":\"中国电信\",\"suspendedIndicator\":\"false\",\"sessionType\":\" \",\"nominalPrice\":\"2.9700000\",\"currency\":\"HKD\",\"changeAmount\":\"-0.1200000\",\"changePercent\":\"-3.8830\",\"dayHighPrice\":\"3.1500000\",\"dayLowPrice\":\"2.9500000\",\"spreadCode\":\"01\",\"preClosePrice\":\"3.0900000\",\"openPrice\":\"3.0600000\",\"volume\":\"175012917\",\"turnover\":\"532989438.0000\",\"boardLotSize\":\"2000\",\"vcmEligible\":\"Y\",\"vcmStatus\":\"N\",\"vcmStarttime\":\"\",\"vcmEndtime\":\"\",\"vcmRefPrice\":\"\",\"vcmUpperLimitPrice\":\"\",\"vcmLowerLimitPrice\":\"\",\"casEligible\":\"Y\",\"casReferencePrice\":\"2.9700000\",\"casUpperLimitPrice\":\"3.1100000\",\"casLowerLimitPrice\":\"2.8300000\",\"asOfDateTime\":\"2021-08-17T16:08:07+0800\",\"posEligible\":\"Y\",\"posReferencePrice\":\"\",\"posBuyUpperPrice\":\"\",\"posBuyLowerPrice\":\"\",\"posSellUpperPrice\":\"\",\"posSellLowerPrice\":\"\",\"auctionType\":\" \",\"delay\":true},{\"symbol\":\"08133\",\"companyNameEN\":\"JETE POWER\",\"companyNameTC\":\"鑄能控股\",\"companyNameSC\":\"铸能控股\",\"suspendedIndicator\":\"false\",\"sessionType\":\" \",\"nominalPrice\":\"0.0110000\",\"currency\":\"HKD\",\"changeAmount\":\"0.0000000\",\"changePercent\":\"0.0000\",\"dayHighPrice\":\"0.0110000\",\"dayLowPrice\":\"0.0100000\",\"spreadCode\":\"01\",\"preClosePrice\":\"0.0110000\",\"openPrice\":\"0.0100000\",\"volume\":\"36380000\",\"turnover\":\"369800.0000\",\"boardLotSize\":\"20000\",\"vcmEligible\":\"N\",\"vcmStatus\":\"\",\"vcmStarttime\":\"\",\"vcmEndtime\":\"\",\"vcmRefPrice\":\"\",\"vcmUpperLimitPrice\":\"\",\"vcmLowerLimitPrice\":\"\",\"casEligible\":\"Y\",\"casReferencePrice\":\"0.0110000\",\"casUpperLimitPrice\":\"0.0110000\",\"casLowerLimitPrice\":\"0.0110000\",\"asOfDateTime\":\"2021-08-17T16:08:03+0800\",\"posEligible\":\"Y\",\"posReferencePrice\":\"\",\"posBuyUpperPrice\":\"\",\"posBuyLowerPrice\":\"\",\"posSellUpperPrice\":\"\",\"posSellLowerPrice\":\"\",\"auctionType\":\" \",\"delay\":true},{\"symbol\":\"01288\",\"companyNameEN\":\"ABC\",\"companyNameTC\":\"農業銀行\",\"companyNameSC\":\"农业银行\",\"suspendedIndicator\":\"false\",\"sessionType\":\" \",\"nominalPrice\":\"2.6100000\",\"currency\":\"HKD\",\"changeAmount\":\"-0.0100000\",\"changePercent\":\"-0.3820\",\"dayHighPrice\":\"2.6300000\",\"dayLowPrice\":\"2.5900000\",\"spreadCode\":\"01\",\"preClosePrice\":\"2.6200000\",\"openPrice\":\"2.6200000\",\"volume\":\"123946417\",\"turnover\":\"322981188.0000\",\"boardLotSize\":\"1000\",\"vcmEligible\":\"Y\",\"vcmStatus\":\"N\",\"vcmStarttime\":\"\",\"vcmEndtime\":\"\",\"vcmRefPrice\":\"\",\"vcmUpperLimitPrice\":\"\",\"vcmLowerLimitPrice\":\"\",\"casEligible\":\"Y\",\"casReferencePrice\":\"2.6200000\",\"casUpperLimitPrice\":\"2.7500000\",\"casLowerLimitPrice\":\"2.4900000\",\"asOfDateTime\":\"2021-08-17T16:08:04+0800\",\"posEligible\":\"Y\",\"posReferencePrice\":\"\",\"posBuyUpperPrice\":\"\",\"posBuyLowerPrice\":\"\",\"posSellUpperPrice\":\"\",\"posSellLowerPrice\":\"\",\"auctionType\":\" \",\"delay\":true},{\"symbol\":\"00762\",\"companyNameEN\":\"CHINA UNICOM\",\"companyNameTC\":\"中國聯通\",\"companyNameSC\":\"中国联通\",\"suspendedIndicator\":\"false\",\"sessionType\":\" \",\"nominalPrice\":\"4.2100000\",\"currency\":\"HKD\",\"changeAmount\":\"-0.0800000\",\"changePercent\":\"-1.8650\",\"dayHighPrice\":\"4.3200000\",\"dayLowPrice\":\"4.1700000\",\"spreadCode\":\"01\",\"preClosePrice\":\"4.2900000\",\"openPrice\":\"4.2600000\",\"volume\":\"72857816\",\"turnover\":\"309163488.0000\",\"boardLotSize\":\"2000\",\"vcmEligible\":\"Y\",\"vcmStatus\":\"N\",\"vcmStarttime\":\"\",\"vcmEndtime\":\"\",\"vcmRefPrice\":\"\",\"vcmUpperLimitPrice\":\"\",\"vcmLowerLimitPrice\":\"\",\"casEligible\":\"Y\",\"casReferencePrice\":\"4.2000000\",\"casUpperLimitPrice\":\"4.3200000\",\"casLowerLimitPrice\":\"4.0200000\",\"asOfDateTime\":\"2021-08-17T16:08:03+0800\",\"posEligible\":\"Y\",\"posReferencePrice\":\"\",\"posBuyUpperPrice\":\"\",\"posBuyLowerPrice\":\"\",\"posSellUpperPrice\":\"\",\"posSellLowerPrice\":\"\",\"auctionType\":\" \",\"delay\":true}]}";
        when(httpClientHelper.doGet(any(String.class),any(String.class),any(HashMap.class))).thenReturn(httpResult3);
        doNothing().when(quoteAccessLogService).saveQuoteAccessLog(any(ArrayList.class));
    }

    @Test
    public void testConvertRequest() throws Exception{
        Map<String, String> serviceRequestMapper = (Map<String, String>)topMoverMidfsService.convertRequest(topMoverRequest,commonRequestHeader);
        assertNotNull(serviceRequestMapper.get("VOL|MAIN"));
    }

    @Test
    public void testResultStateConvertRequest(){
        try {
            response.setCacheExistingFlag("N");
            Map<String,String> serviceRequestMapper =(Map<String,String>)topMoverMidfsService.convertRequest(topMoverRequest,commonRequestHeader);
            assertNotNull(serviceRequestMapper);
        }catch (Exception e){
            e.printStackTrace();
        }
    }

    @Test
    public void testMoveTypeConvertRequest(){
        try {
            topMoverRequest.setMoverType(null);
            Map<String,String> serviceRequestMapper =(Map<String,String>)topMoverMidfsService.convertRequest(topMoverRequest,commonRequestHeader);
            assertNotNull(serviceRequestMapper);
        }catch (Exception e){
            e.printStackTrace();
        }
    }

    @Test
    public void testExecute() throws Exception{
        Map<String,String> serviceRequestMapper =(Map<String,String>)topMoverMidfsService.convertRequest(topMoverRequest,commonRequestHeader);
        Map<String, String> serviceResponseMapper =(Map<String, String>) topMoverMidfsService.execute(serviceRequestMapper);
        assertNotNull(serviceResponseMapper.get("VOL|MAIN"));
    }

    @Test
    public void testvValidateServiceResponse() throws Exception{
        Map<String,String> serviceRequestMapper =(Map<String,String>)topMoverMidfsService.convertRequest(topMoverRequest,commonRequestHeader);
        Map<String, String> serviceResponseMapper =(Map<String, String>) topMoverMidfsService.execute(serviceRequestMapper);
        Map<String, String> response = (Map<String, String>) topMoverMidfsService.validateServiceResponse(serviceResponseMapper);
        assertNotNull(response.get("VOL|MAIN"));

    }

    @Test
    public void testvValidateService01Response(){
        try {
            String httpResult3 = "{\"responseCode\":\"01\",\"priceQuotes\":[{\"symbol\":\"01398\",\"companyNameEN\":\"ICBC\",\"companyNameTC\":\"工商銀行\",\"companyNameSC\":\"工商银行\",\"suspendedIndicator\":\"false\",\"sessionType\":\" \",\"nominalPrice\":\"4.4000000\",\"currency\":\"HKD\",\"changeAmount\":\"-0.0200000\",\"changePercent\":\"-0.4520\",\"dayHighPrice\":\"4.4300000\",\"dayLowPrice\":\"4.3800000\",\"spreadCode\":\"01\",\"preClosePrice\":\"4.4200000\",\"openPrice\":\"4.4200000\",\"volume\":\"230133072\",\"turnover\":\"1012405388.0000\",\"boardLotSize\":\"1000\",\"vcmEligible\":\"Y\",\"vcmStatus\":\"N\",\"vcmStarttime\":\"\",\"vcmEndtime\":\"\",\"vcmRefPrice\":\"\",\"vcmUpperLimitPrice\":\"\",\"vcmLowerLimitPrice\":\"\",\"casEligible\":\"Y\",\"casReferencePrice\":\"4.4100000\",\"casUpperLimitPrice\":\"4.6300000\",\"casLowerLimitPrice\":\"4.1900000\",\"asOfDateTime\":\"2021-08-17T16:08:04+0800\",\"posEligible\":\"Y\",\"posReferencePrice\":\"\",\"posBuyUpperPrice\":\"\",\"posBuyLowerPrice\":\"\",\"posSellUpperPrice\":\"\",\"posSellLowerPrice\":\"\",\"auctionType\":\" \",\"delay\":true},{\"symbol\":\"00939\",\"companyNameEN\":\"CCB\",\"companyNameTC\":\"建設銀行\",\"companyNameSC\":\"建设银行\",\"suspendedIndicator\":\"false\",\"sessionType\":\" \",\"nominalPrice\":\"5.4300000\",\"currency\":\"HKD\",\"changeAmount\":\"-0.0300000\",\"changePercent\":\"-0.5490\",\"dayHighPrice\":\"5.4700000\",\"dayLowPrice\":\"5.3800000\",\"spreadCode\":\"01\",\"preClosePrice\":\"5.4600000\",\"openPrice\":\"5.4600000\",\"volume\":\"300197197\",\"turnover\":\"1629160256.0000\",\"boardLotSize\":\"1000\",\"vcmEligible\":\"Y\",\"vcmStatus\":\"N\",\"vcmStarttime\":\"\",\"vcmEndtime\":\"\",\"vcmRefPrice\":\"\",\"vcmUpperLimitPrice\":\"\",\"vcmLowerLimitPrice\":\"\",\"casEligible\":\"Y\",\"casReferencePrice\":\"5.4200000\",\"casUpperLimitPrice\":\"5.6900000\",\"casLowerLimitPrice\":\"5.1500000\",\"asOfDateTime\":\"2021-08-17T16:08:03+0800\",\"posEligible\":\"Y\",\"posReferencePrice\":\"\",\"posBuyUpperPrice\":\"\",\"posBuyLowerPrice\":\"\",\"posSellUpperPrice\":\"\",\"posSellLowerPrice\":\"\",\"auctionType\":\" \",\"delay\":true},{\"symbol\":\"03988\",\"companyNameEN\":\"BANK OF CHINA\",\"companyNameTC\":\"中國銀行\",\"companyNameSC\":\"中国银行\",\"suspendedIndicator\":\"false\",\"sessionType\":\" \",\"nominalPrice\":\"2.7100000\",\"currency\":\"HKD\",\"changeAmount\":\"0.0000000\",\"changePercent\":\"0.0000\",\"dayHighPrice\":\"2.7200000\",\"dayLowPrice\":\"2.6900000\",\"spreadCode\":\"01\",\"preClosePrice\":\"2.7100000\",\"openPrice\":\"2.7100000\",\"volume\":\"232339719\",\"turnover\":\"628220483.0000\",\"boardLotSize\":\"1000\",\"vcmEligible\":\"Y\",\"vcmStatus\":\"N\",\"vcmStarttime\":\"\",\"vcmEndtime\":\"\",\"vcmRefPrice\":\"\",\"vcmUpperLimitPrice\":\"\",\"vcmLowerLimitPrice\":\"\",\"casEligible\":\"Y\",\"casReferencePrice\":\"2.7100000\",\"casUpperLimitPrice\":\"2.8400000\",\"casLowerLimitPrice\":\"2.5800000\",\"asOfDateTime\":\"2021-08-17T16:08:06+0800\",\"posEligible\":\"Y\",\"posReferencePrice\":\"\",\"posBuyUpperPrice\":\"\",\"posBuyLowerPrice\":\"\",\"posSellUpperPrice\":\"\",\"posSellLowerPrice\":\"\",\"auctionType\":\" \",\"delay\":true},{\"symbol\":\"02800\",\"companyNameEN\":\"TRACKER FUND\",\"companyNameTC\":\"盈富基金\",\"companyNameSC\":\"盈富基金\",\"suspendedIndicator\":\"false\",\"sessionType\":\" \",\"nominalPrice\":\"26.7000000\",\"currency\":\"HKD\",\"changeAmount\":\"-1.1600000\",\"changePercent\":\"-4.1640\",\"dayHighPrice\":\"27.5000000\",\"dayLowPrice\":\"26.7000000\",\"spreadCode\":\"05\",\"preClosePrice\":\"27.8600000\",\"openPrice\":\"27.5000000\",\"volume\":\"304025928\",\"turnover\":\"8216446664.0000\",\"boardLotSize\":\"500\",\"vcmEligible\":\"N\",\"vcmStatus\":\"\",\"vcmStarttime\":\"\",\"vcmEndtime\":\"\",\"vcmRefPrice\":\"\",\"vcmUpperLimitPrice\":\"\",\"vcmLowerLimitPrice\":\"\",\"casEligible\":\"Y\",\"casReferencePrice\":\"26.7600000\",\"casUpperLimitPrice\":\"27.8600000\",\"casLowerLimitPrice\":\"26.6800000\",\"asOfDateTime\":\"2021-08-17T16:08:06+0800\",\"posEligible\":\"Y\",\"posReferencePrice\":\"\",\"posBuyUpperPrice\":\"\",\"posBuyLowerPrice\":\"\",\"posSellUpperPrice\":\"\",\"posSellLowerPrice\":\"\",\"auctionType\":\" \",\"delay\":true},{\"symbol\":\"00857\",\"companyNameEN\":\"PETROCHINA\",\"companyNameTC\":\"中國石油股份\",\"companyNameSC\":\"中国石油股份\",\"suspendedIndicator\":\"false\",\"sessionType\":\" \",\"nominalPrice\":\"3.2200000\",\"currency\":\"HKD\",\"changeAmount\":\"-0.0700000\",\"changePercent\":\"-2.1280\",\"dayHighPrice\":\"3.2800000\",\"dayLowPrice\":\"3.2100000\",\"spreadCode\":\"01\",\"preClosePrice\":\"3.2900000\",\"openPrice\":\"3.2700000\",\"volume\":\"100239506\",\"turnover\":\"324780909.0000\",\"boardLotSize\":\"2000\",\"vcmEligible\":\"Y\",\"vcmStatus\":\"N\",\"vcmStarttime\":\"\",\"vcmEndtime\":\"\",\"vcmRefPrice\":\"\",\"vcmUpperLimitPrice\":\"\",\"vcmLowerLimitPrice\":\"\",\"casEligible\":\"Y\",\"casReferencePrice\":\"3.2200000\",\"casUpperLimitPrice\":\"3.3800000\",\"casLowerLimitPrice\":\"3.0600000\",\"asOfDateTime\":\"2021-08-17T16:08:07+0800\",\"posEligible\":\"Y\",\"posReferencePrice\":\"\",\"posBuyUpperPrice\":\"\",\"posBuyLowerPrice\":\"\",\"posSellUpperPrice\":\"\",\"posSellLowerPrice\":\"\",\"auctionType\":\" \",\"delay\":true},{\"symbol\":\"01091\",\"companyNameEN\":\"SOUTH MANGANESE\",\"companyNameTC\":\"南方錳業\",\"companyNameSC\":\"南方锰业\",\"suspendedIndicator\":\"false\",\"sessionType\":\" \",\"nominalPrice\":\"1.0900000\",\"currency\":\"HKD\",\"changeAmount\":\"0.2400000\",\"changePercent\":\"28.2350\",\"dayHighPrice\":\"1.1300000\",\"dayLowPrice\":\"0.9000000\",\"spreadCode\":\"01\",\"preClosePrice\":\"0.8500000\",\"openPrice\":\"0.9000000\",\"volume\":\"231186559\",\"turnover\":\"240808084.0000\",\"boardLotSize\":\"1000\",\"vcmEligible\":\"N\",\"vcmStatus\":\"\",\"vcmStarttime\":\"\",\"vcmEndtime\":\"\",\"vcmRefPrice\":\"\",\"vcmUpperLimitPrice\":\"\",\"vcmLowerLimitPrice\":\"\",\"casEligible\":\"Y\",\"casReferencePrice\":\"1.0900000\",\"casUpperLimitPrice\":\"1.1200000\",\"casLowerLimitPrice\":\"1.0400000\",\"asOfDateTime\":\"2021-08-17T16:08:06+0800\",\"posEligible\":\"Y\",\"posReferencePrice\":\"\",\"posBuyUpperPrice\":\"\",\"posBuyLowerPrice\":\"\",\"posSellUpperPrice\":\"\",\"posSellLowerPrice\":\"\",\"auctionType\":\" \",\"delay\":true},{\"symbol\":\"00728\",\"companyNameEN\":\"CHINA TELECOM\",\"companyNameTC\":\"中國電信\",\"companyNameSC\":\"中国电信\",\"suspendedIndicator\":\"false\",\"sessionType\":\" \",\"nominalPrice\":\"2.9700000\",\"currency\":\"HKD\",\"changeAmount\":\"-0.1200000\",\"changePercent\":\"-3.8830\",\"dayHighPrice\":\"3.1500000\",\"dayLowPrice\":\"2.9500000\",\"spreadCode\":\"01\",\"preClosePrice\":\"3.0900000\",\"openPrice\":\"3.0600000\",\"volume\":\"175012917\",\"turnover\":\"532989438.0000\",\"boardLotSize\":\"2000\",\"vcmEligible\":\"Y\",\"vcmStatus\":\"N\",\"vcmStarttime\":\"\",\"vcmEndtime\":\"\",\"vcmRefPrice\":\"\",\"vcmUpperLimitPrice\":\"\",\"vcmLowerLimitPrice\":\"\",\"casEligible\":\"Y\",\"casReferencePrice\":\"2.9700000\",\"casUpperLimitPrice\":\"3.1100000\",\"casLowerLimitPrice\":\"2.8300000\",\"asOfDateTime\":\"2021-08-17T16:08:07+0800\",\"posEligible\":\"Y\",\"posReferencePrice\":\"\",\"posBuyUpperPrice\":\"\",\"posBuyLowerPrice\":\"\",\"posSellUpperPrice\":\"\",\"posSellLowerPrice\":\"\",\"auctionType\":\" \",\"delay\":true},{\"symbol\":\"08133\",\"companyNameEN\":\"JETE POWER\",\"companyNameTC\":\"鑄能控股\",\"companyNameSC\":\"铸能控股\",\"suspendedIndicator\":\"false\",\"sessionType\":\" \",\"nominalPrice\":\"0.0110000\",\"currency\":\"HKD\",\"changeAmount\":\"0.0000000\",\"changePercent\":\"0.0000\",\"dayHighPrice\":\"0.0110000\",\"dayLowPrice\":\"0.0100000\",\"spreadCode\":\"01\",\"preClosePrice\":\"0.0110000\",\"openPrice\":\"0.0100000\",\"volume\":\"36380000\",\"turnover\":\"369800.0000\",\"boardLotSize\":\"20000\",\"vcmEligible\":\"N\",\"vcmStatus\":\"\",\"vcmStarttime\":\"\",\"vcmEndtime\":\"\",\"vcmRefPrice\":\"\",\"vcmUpperLimitPrice\":\"\",\"vcmLowerLimitPrice\":\"\",\"casEligible\":\"Y\",\"casReferencePrice\":\"0.0110000\",\"casUpperLimitPrice\":\"0.0110000\",\"casLowerLimitPrice\":\"0.0110000\",\"asOfDateTime\":\"2021-08-17T16:08:03+0800\",\"posEligible\":\"Y\",\"posReferencePrice\":\"\",\"posBuyUpperPrice\":\"\",\"posBuyLowerPrice\":\"\",\"posSellUpperPrice\":\"\",\"posSellLowerPrice\":\"\",\"auctionType\":\" \",\"delay\":true},{\"symbol\":\"01288\",\"companyNameEN\":\"ABC\",\"companyNameTC\":\"農業銀行\",\"companyNameSC\":\"农业银行\",\"suspendedIndicator\":\"false\",\"sessionType\":\" \",\"nominalPrice\":\"2.6100000\",\"currency\":\"HKD\",\"changeAmount\":\"-0.0100000\",\"changePercent\":\"-0.3820\",\"dayHighPrice\":\"2.6300000\",\"dayLowPrice\":\"2.5900000\",\"spreadCode\":\"01\",\"preClosePrice\":\"2.6200000\",\"openPrice\":\"2.6200000\",\"volume\":\"123946417\",\"turnover\":\"322981188.0000\",\"boardLotSize\":\"1000\",\"vcmEligible\":\"Y\",\"vcmStatus\":\"N\",\"vcmStarttime\":\"\",\"vcmEndtime\":\"\",\"vcmRefPrice\":\"\",\"vcmUpperLimitPrice\":\"\",\"vcmLowerLimitPrice\":\"\",\"casEligible\":\"Y\",\"casReferencePrice\":\"2.6200000\",\"casUpperLimitPrice\":\"2.7500000\",\"casLowerLimitPrice\":\"2.4900000\",\"asOfDateTime\":\"2021-08-17T16:08:04+0800\",\"posEligible\":\"Y\",\"posReferencePrice\":\"\",\"posBuyUpperPrice\":\"\",\"posBuyLowerPrice\":\"\",\"posSellUpperPrice\":\"\",\"posSellLowerPrice\":\"\",\"auctionType\":\" \",\"delay\":true},{\"symbol\":\"00762\",\"companyNameEN\":\"CHINA UNICOM\",\"companyNameTC\":\"中國聯通\",\"companyNameSC\":\"中国联通\",\"suspendedIndicator\":\"false\",\"sessionType\":\" \",\"nominalPrice\":\"4.2100000\",\"currency\":\"HKD\",\"changeAmount\":\"-0.0800000\",\"changePercent\":\"-1.8650\",\"dayHighPrice\":\"4.3200000\",\"dayLowPrice\":\"4.1700000\",\"spreadCode\":\"01\",\"preClosePrice\":\"4.2900000\",\"openPrice\":\"4.2600000\",\"volume\":\"72857816\",\"turnover\":\"309163488.0000\",\"boardLotSize\":\"2000\",\"vcmEligible\":\"Y\",\"vcmStatus\":\"N\",\"vcmStarttime\":\"\",\"vcmEndtime\":\"\",\"vcmRefPrice\":\"\",\"vcmUpperLimitPrice\":\"\",\"vcmLowerLimitPrice\":\"\",\"casEligible\":\"Y\",\"casReferencePrice\":\"4.2000000\",\"casUpperLimitPrice\":\"4.3200000\",\"casLowerLimitPrice\":\"4.0200000\",\"asOfDateTime\":\"2021-08-17T16:08:03+0800\",\"posEligible\":\"Y\",\"posReferencePrice\":\"\",\"posBuyUpperPrice\":\"\",\"posBuyLowerPrice\":\"\",\"posSellUpperPrice\":\"\",\"posSellLowerPrice\":\"\",\"auctionType\":\" \",\"delay\":true}]}";
            when(httpClientHelper.doGet(any(String.class),any(String.class),any(HashMap.class))).thenReturn(httpResult3);
            Map<String,String> serviceRequestMapper =(Map<String,String>)topMoverMidfsService.convertRequest(topMoverRequest,commonRequestHeader);
            Map<String, String> serviceResponseMapper =(Map<String, String>) topMoverMidfsService.execute(serviceRequestMapper);
            Object response =  topMoverMidfsService.validateServiceResponse(serviceResponseMapper);
            assertNotNull(response);
        }catch (Exception e){
            e.printStackTrace();
        }
    }

    @Test
    public void testvValidateService02Response(){
        try {
            String httpResult3 = "{\"responseCode\":\"02\",\"priceQuotes\":[{\"symbol\":\"01398\",\"companyNameEN\":\"ICBC\",\"companyNameTC\":\"工商銀行\",\"companyNameSC\":\"工商银行\",\"suspendedIndicator\":\"false\",\"sessionType\":\" \",\"nominalPrice\":\"4.4000000\",\"currency\":\"HKD\",\"changeAmount\":\"-0.0200000\",\"changePercent\":\"-0.4520\",\"dayHighPrice\":\"4.4300000\",\"dayLowPrice\":\"4.3800000\",\"spreadCode\":\"01\",\"preClosePrice\":\"4.4200000\",\"openPrice\":\"4.4200000\",\"volume\":\"230133072\",\"turnover\":\"1012405388.0000\",\"boardLotSize\":\"1000\",\"vcmEligible\":\"Y\",\"vcmStatus\":\"N\",\"vcmStarttime\":\"\",\"vcmEndtime\":\"\",\"vcmRefPrice\":\"\",\"vcmUpperLimitPrice\":\"\",\"vcmLowerLimitPrice\":\"\",\"casEligible\":\"Y\",\"casReferencePrice\":\"4.4100000\",\"casUpperLimitPrice\":\"4.6300000\",\"casLowerLimitPrice\":\"4.1900000\",\"asOfDateTime\":\"2021-08-17T16:08:04+0800\",\"posEligible\":\"Y\",\"posReferencePrice\":\"\",\"posBuyUpperPrice\":\"\",\"posBuyLowerPrice\":\"\",\"posSellUpperPrice\":\"\",\"posSellLowerPrice\":\"\",\"auctionType\":\" \",\"delay\":true},{\"symbol\":\"00939\",\"companyNameEN\":\"CCB\",\"companyNameTC\":\"建設銀行\",\"companyNameSC\":\"建设银行\",\"suspendedIndicator\":\"false\",\"sessionType\":\" \",\"nominalPrice\":\"5.4300000\",\"currency\":\"HKD\",\"changeAmount\":\"-0.0300000\",\"changePercent\":\"-0.5490\",\"dayHighPrice\":\"5.4700000\",\"dayLowPrice\":\"5.3800000\",\"spreadCode\":\"01\",\"preClosePrice\":\"5.4600000\",\"openPrice\":\"5.4600000\",\"volume\":\"300197197\",\"turnover\":\"1629160256.0000\",\"boardLotSize\":\"1000\",\"vcmEligible\":\"Y\",\"vcmStatus\":\"N\",\"vcmStarttime\":\"\",\"vcmEndtime\":\"\",\"vcmRefPrice\":\"\",\"vcmUpperLimitPrice\":\"\",\"vcmLowerLimitPrice\":\"\",\"casEligible\":\"Y\",\"casReferencePrice\":\"5.4200000\",\"casUpperLimitPrice\":\"5.6900000\",\"casLowerLimitPrice\":\"5.1500000\",\"asOfDateTime\":\"2021-08-17T16:08:03+0800\",\"posEligible\":\"Y\",\"posReferencePrice\":\"\",\"posBuyUpperPrice\":\"\",\"posBuyLowerPrice\":\"\",\"posSellUpperPrice\":\"\",\"posSellLowerPrice\":\"\",\"auctionType\":\" \",\"delay\":true},{\"symbol\":\"03988\",\"companyNameEN\":\"BANK OF CHINA\",\"companyNameTC\":\"中國銀行\",\"companyNameSC\":\"中国银行\",\"suspendedIndicator\":\"false\",\"sessionType\":\" \",\"nominalPrice\":\"2.7100000\",\"currency\":\"HKD\",\"changeAmount\":\"0.0000000\",\"changePercent\":\"0.0000\",\"dayHighPrice\":\"2.7200000\",\"dayLowPrice\":\"2.6900000\",\"spreadCode\":\"01\",\"preClosePrice\":\"2.7100000\",\"openPrice\":\"2.7100000\",\"volume\":\"232339719\",\"turnover\":\"628220483.0000\",\"boardLotSize\":\"1000\",\"vcmEligible\":\"Y\",\"vcmStatus\":\"N\",\"vcmStarttime\":\"\",\"vcmEndtime\":\"\",\"vcmRefPrice\":\"\",\"vcmUpperLimitPrice\":\"\",\"vcmLowerLimitPrice\":\"\",\"casEligible\":\"Y\",\"casReferencePrice\":\"2.7100000\",\"casUpperLimitPrice\":\"2.8400000\",\"casLowerLimitPrice\":\"2.5800000\",\"asOfDateTime\":\"2021-08-17T16:08:06+0800\",\"posEligible\":\"Y\",\"posReferencePrice\":\"\",\"posBuyUpperPrice\":\"\",\"posBuyLowerPrice\":\"\",\"posSellUpperPrice\":\"\",\"posSellLowerPrice\":\"\",\"auctionType\":\" \",\"delay\":true},{\"symbol\":\"02800\",\"companyNameEN\":\"TRACKER FUND\",\"companyNameTC\":\"盈富基金\",\"companyNameSC\":\"盈富基金\",\"suspendedIndicator\":\"false\",\"sessionType\":\" \",\"nominalPrice\":\"26.7000000\",\"currency\":\"HKD\",\"changeAmount\":\"-1.1600000\",\"changePercent\":\"-4.1640\",\"dayHighPrice\":\"27.5000000\",\"dayLowPrice\":\"26.7000000\",\"spreadCode\":\"05\",\"preClosePrice\":\"27.8600000\",\"openPrice\":\"27.5000000\",\"volume\":\"304025928\",\"turnover\":\"8216446664.0000\",\"boardLotSize\":\"500\",\"vcmEligible\":\"N\",\"vcmStatus\":\"\",\"vcmStarttime\":\"\",\"vcmEndtime\":\"\",\"vcmRefPrice\":\"\",\"vcmUpperLimitPrice\":\"\",\"vcmLowerLimitPrice\":\"\",\"casEligible\":\"Y\",\"casReferencePrice\":\"26.7600000\",\"casUpperLimitPrice\":\"27.8600000\",\"casLowerLimitPrice\":\"26.6800000\",\"asOfDateTime\":\"2021-08-17T16:08:06+0800\",\"posEligible\":\"Y\",\"posReferencePrice\":\"\",\"posBuyUpperPrice\":\"\",\"posBuyLowerPrice\":\"\",\"posSellUpperPrice\":\"\",\"posSellLowerPrice\":\"\",\"auctionType\":\" \",\"delay\":true},{\"symbol\":\"00857\",\"companyNameEN\":\"PETROCHINA\",\"companyNameTC\":\"中國石油股份\",\"companyNameSC\":\"中国石油股份\",\"suspendedIndicator\":\"false\",\"sessionType\":\" \",\"nominalPrice\":\"3.2200000\",\"currency\":\"HKD\",\"changeAmount\":\"-0.0700000\",\"changePercent\":\"-2.1280\",\"dayHighPrice\":\"3.2800000\",\"dayLowPrice\":\"3.2100000\",\"spreadCode\":\"01\",\"preClosePrice\":\"3.2900000\",\"openPrice\":\"3.2700000\",\"volume\":\"100239506\",\"turnover\":\"324780909.0000\",\"boardLotSize\":\"2000\",\"vcmEligible\":\"Y\",\"vcmStatus\":\"N\",\"vcmStarttime\":\"\",\"vcmEndtime\":\"\",\"vcmRefPrice\":\"\",\"vcmUpperLimitPrice\":\"\",\"vcmLowerLimitPrice\":\"\",\"casEligible\":\"Y\",\"casReferencePrice\":\"3.2200000\",\"casUpperLimitPrice\":\"3.3800000\",\"casLowerLimitPrice\":\"3.0600000\",\"asOfDateTime\":\"2021-08-17T16:08:07+0800\",\"posEligible\":\"Y\",\"posReferencePrice\":\"\",\"posBuyUpperPrice\":\"\",\"posBuyLowerPrice\":\"\",\"posSellUpperPrice\":\"\",\"posSellLowerPrice\":\"\",\"auctionType\":\" \",\"delay\":true},{\"symbol\":\"01091\",\"companyNameEN\":\"SOUTH MANGANESE\",\"companyNameTC\":\"南方錳業\",\"companyNameSC\":\"南方锰业\",\"suspendedIndicator\":\"false\",\"sessionType\":\" \",\"nominalPrice\":\"1.0900000\",\"currency\":\"HKD\",\"changeAmount\":\"0.2400000\",\"changePercent\":\"28.2350\",\"dayHighPrice\":\"1.1300000\",\"dayLowPrice\":\"0.9000000\",\"spreadCode\":\"01\",\"preClosePrice\":\"0.8500000\",\"openPrice\":\"0.9000000\",\"volume\":\"231186559\",\"turnover\":\"240808084.0000\",\"boardLotSize\":\"1000\",\"vcmEligible\":\"N\",\"vcmStatus\":\"\",\"vcmStarttime\":\"\",\"vcmEndtime\":\"\",\"vcmRefPrice\":\"\",\"vcmUpperLimitPrice\":\"\",\"vcmLowerLimitPrice\":\"\",\"casEligible\":\"Y\",\"casReferencePrice\":\"1.0900000\",\"casUpperLimitPrice\":\"1.1200000\",\"casLowerLimitPrice\":\"1.0400000\",\"asOfDateTime\":\"2021-08-17T16:08:06+0800\",\"posEligible\":\"Y\",\"posReferencePrice\":\"\",\"posBuyUpperPrice\":\"\",\"posBuyLowerPrice\":\"\",\"posSellUpperPrice\":\"\",\"posSellLowerPrice\":\"\",\"auctionType\":\" \",\"delay\":true},{\"symbol\":\"00728\",\"companyNameEN\":\"CHINA TELECOM\",\"companyNameTC\":\"中國電信\",\"companyNameSC\":\"中国电信\",\"suspendedIndicator\":\"false\",\"sessionType\":\" \",\"nominalPrice\":\"2.9700000\",\"currency\":\"HKD\",\"changeAmount\":\"-0.1200000\",\"changePercent\":\"-3.8830\",\"dayHighPrice\":\"3.1500000\",\"dayLowPrice\":\"2.9500000\",\"spreadCode\":\"01\",\"preClosePrice\":\"3.0900000\",\"openPrice\":\"3.0600000\",\"volume\":\"175012917\",\"turnover\":\"532989438.0000\",\"boardLotSize\":\"2000\",\"vcmEligible\":\"Y\",\"vcmStatus\":\"N\",\"vcmStarttime\":\"\",\"vcmEndtime\":\"\",\"vcmRefPrice\":\"\",\"vcmUpperLimitPrice\":\"\",\"vcmLowerLimitPrice\":\"\",\"casEligible\":\"Y\",\"casReferencePrice\":\"2.9700000\",\"casUpperLimitPrice\":\"3.1100000\",\"casLowerLimitPrice\":\"2.8300000\",\"asOfDateTime\":\"2021-08-17T16:08:07+0800\",\"posEligible\":\"Y\",\"posReferencePrice\":\"\",\"posBuyUpperPrice\":\"\",\"posBuyLowerPrice\":\"\",\"posSellUpperPrice\":\"\",\"posSellLowerPrice\":\"\",\"auctionType\":\" \",\"delay\":true},{\"symbol\":\"08133\",\"companyNameEN\":\"JETE POWER\",\"companyNameTC\":\"鑄能控股\",\"companyNameSC\":\"铸能控股\",\"suspendedIndicator\":\"false\",\"sessionType\":\" \",\"nominalPrice\":\"0.0110000\",\"currency\":\"HKD\",\"changeAmount\":\"0.0000000\",\"changePercent\":\"0.0000\",\"dayHighPrice\":\"0.0110000\",\"dayLowPrice\":\"0.0100000\",\"spreadCode\":\"01\",\"preClosePrice\":\"0.0110000\",\"openPrice\":\"0.0100000\",\"volume\":\"36380000\",\"turnover\":\"369800.0000\",\"boardLotSize\":\"20000\",\"vcmEligible\":\"N\",\"vcmStatus\":\"\",\"vcmStarttime\":\"\",\"vcmEndtime\":\"\",\"vcmRefPrice\":\"\",\"vcmUpperLimitPrice\":\"\",\"vcmLowerLimitPrice\":\"\",\"casEligible\":\"Y\",\"casReferencePrice\":\"0.0110000\",\"casUpperLimitPrice\":\"0.0110000\",\"casLowerLimitPrice\":\"0.0110000\",\"asOfDateTime\":\"2021-08-17T16:08:03+0800\",\"posEligible\":\"Y\",\"posReferencePrice\":\"\",\"posBuyUpperPrice\":\"\",\"posBuyLowerPrice\":\"\",\"posSellUpperPrice\":\"\",\"posSellLowerPrice\":\"\",\"auctionType\":\" \",\"delay\":true},{\"symbol\":\"01288\",\"companyNameEN\":\"ABC\",\"companyNameTC\":\"農業銀行\",\"companyNameSC\":\"农业银行\",\"suspendedIndicator\":\"false\",\"sessionType\":\" \",\"nominalPrice\":\"2.6100000\",\"currency\":\"HKD\",\"changeAmount\":\"-0.0100000\",\"changePercent\":\"-0.3820\",\"dayHighPrice\":\"2.6300000\",\"dayLowPrice\":\"2.5900000\",\"spreadCode\":\"01\",\"preClosePrice\":\"2.6200000\",\"openPrice\":\"2.6200000\",\"volume\":\"123946417\",\"turnover\":\"322981188.0000\",\"boardLotSize\":\"1000\",\"vcmEligible\":\"Y\",\"vcmStatus\":\"N\",\"vcmStarttime\":\"\",\"vcmEndtime\":\"\",\"vcmRefPrice\":\"\",\"vcmUpperLimitPrice\":\"\",\"vcmLowerLimitPrice\":\"\",\"casEligible\":\"Y\",\"casReferencePrice\":\"2.6200000\",\"casUpperLimitPrice\":\"2.7500000\",\"casLowerLimitPrice\":\"2.4900000\",\"asOfDateTime\":\"2021-08-17T16:08:04+0800\",\"posEligible\":\"Y\",\"posReferencePrice\":\"\",\"posBuyUpperPrice\":\"\",\"posBuyLowerPrice\":\"\",\"posSellUpperPrice\":\"\",\"posSellLowerPrice\":\"\",\"auctionType\":\" \",\"delay\":true},{\"symbol\":\"00762\",\"companyNameEN\":\"CHINA UNICOM\",\"companyNameTC\":\"中國聯通\",\"companyNameSC\":\"中国联通\",\"suspendedIndicator\":\"false\",\"sessionType\":\" \",\"nominalPrice\":\"4.2100000\",\"currency\":\"HKD\",\"changeAmount\":\"-0.0800000\",\"changePercent\":\"-1.8650\",\"dayHighPrice\":\"4.3200000\",\"dayLowPrice\":\"4.1700000\",\"spreadCode\":\"01\",\"preClosePrice\":\"4.2900000\",\"openPrice\":\"4.2600000\",\"volume\":\"72857816\",\"turnover\":\"309163488.0000\",\"boardLotSize\":\"2000\",\"vcmEligible\":\"Y\",\"vcmStatus\":\"N\",\"vcmStarttime\":\"\",\"vcmEndtime\":\"\",\"vcmRefPrice\":\"\",\"vcmUpperLimitPrice\":\"\",\"vcmLowerLimitPrice\":\"\",\"casEligible\":\"Y\",\"casReferencePrice\":\"4.2000000\",\"casUpperLimitPrice\":\"4.3200000\",\"casLowerLimitPrice\":\"4.0200000\",\"asOfDateTime\":\"2021-08-17T16:08:03+0800\",\"posEligible\":\"Y\",\"posReferencePrice\":\"\",\"posBuyUpperPrice\":\"\",\"posBuyLowerPrice\":\"\",\"posSellUpperPrice\":\"\",\"posSellLowerPrice\":\"\",\"auctionType\":\" \",\"delay\":true}]}";
            when(httpClientHelper.doGet(any(String.class),any(String.class),any(HashMap.class))).thenReturn(httpResult3);
            Map<String,String> serviceRequestMapper =(Map<String,String>)topMoverMidfsService.convertRequest(topMoverRequest,commonRequestHeader);
            Map<String, String> serviceResponseMapper =(Map<String, String>) topMoverMidfsService.execute(serviceRequestMapper);
            Object response =  topMoverMidfsService.validateServiceResponse(serviceResponseMapper);
            assertNotNull(response);
        }catch (Exception e){
            e.printStackTrace();
        }
    }

    @Test
    public void testvValidateService03Response(){
        try {
            String httpResult3 = "{\"responseCode\":\"03\",\"priceQuotes\":[{\"symbol\":\"01398\",\"companyNameEN\":\"ICBC\",\"companyNameTC\":\"工商銀行\",\"companyNameSC\":\"工商银行\",\"suspendedIndicator\":\"false\",\"sessionType\":\" \",\"nominalPrice\":\"4.4000000\",\"currency\":\"HKD\",\"changeAmount\":\"-0.0200000\",\"changePercent\":\"-0.4520\",\"dayHighPrice\":\"4.4300000\",\"dayLowPrice\":\"4.3800000\",\"spreadCode\":\"01\",\"preClosePrice\":\"4.4200000\",\"openPrice\":\"4.4200000\",\"volume\":\"230133072\",\"turnover\":\"1012405388.0000\",\"boardLotSize\":\"1000\",\"vcmEligible\":\"Y\",\"vcmStatus\":\"N\",\"vcmStarttime\":\"\",\"vcmEndtime\":\"\",\"vcmRefPrice\":\"\",\"vcmUpperLimitPrice\":\"\",\"vcmLowerLimitPrice\":\"\",\"casEligible\":\"Y\",\"casReferencePrice\":\"4.4100000\",\"casUpperLimitPrice\":\"4.6300000\",\"casLowerLimitPrice\":\"4.1900000\",\"asOfDateTime\":\"2021-08-17T16:08:04+0800\",\"posEligible\":\"Y\",\"posReferencePrice\":\"\",\"posBuyUpperPrice\":\"\",\"posBuyLowerPrice\":\"\",\"posSellUpperPrice\":\"\",\"posSellLowerPrice\":\"\",\"auctionType\":\" \",\"delay\":true},{\"symbol\":\"00939\",\"companyNameEN\":\"CCB\",\"companyNameTC\":\"建設銀行\",\"companyNameSC\":\"建设银行\",\"suspendedIndicator\":\"false\",\"sessionType\":\" \",\"nominalPrice\":\"5.4300000\",\"currency\":\"HKD\",\"changeAmount\":\"-0.0300000\",\"changePercent\":\"-0.5490\",\"dayHighPrice\":\"5.4700000\",\"dayLowPrice\":\"5.3800000\",\"spreadCode\":\"01\",\"preClosePrice\":\"5.4600000\",\"openPrice\":\"5.4600000\",\"volume\":\"300197197\",\"turnover\":\"1629160256.0000\",\"boardLotSize\":\"1000\",\"vcmEligible\":\"Y\",\"vcmStatus\":\"N\",\"vcmStarttime\":\"\",\"vcmEndtime\":\"\",\"vcmRefPrice\":\"\",\"vcmUpperLimitPrice\":\"\",\"vcmLowerLimitPrice\":\"\",\"casEligible\":\"Y\",\"casReferencePrice\":\"5.4200000\",\"casUpperLimitPrice\":\"5.6900000\",\"casLowerLimitPrice\":\"5.1500000\",\"asOfDateTime\":\"2021-08-17T16:08:03+0800\",\"posEligible\":\"Y\",\"posReferencePrice\":\"\",\"posBuyUpperPrice\":\"\",\"posBuyLowerPrice\":\"\",\"posSellUpperPrice\":\"\",\"posSellLowerPrice\":\"\",\"auctionType\":\" \",\"delay\":true},{\"symbol\":\"03988\",\"companyNameEN\":\"BANK OF CHINA\",\"companyNameTC\":\"中國銀行\",\"companyNameSC\":\"中国银行\",\"suspendedIndicator\":\"false\",\"sessionType\":\" \",\"nominalPrice\":\"2.7100000\",\"currency\":\"HKD\",\"changeAmount\":\"0.0000000\",\"changePercent\":\"0.0000\",\"dayHighPrice\":\"2.7200000\",\"dayLowPrice\":\"2.6900000\",\"spreadCode\":\"01\",\"preClosePrice\":\"2.7100000\",\"openPrice\":\"2.7100000\",\"volume\":\"232339719\",\"turnover\":\"628220483.0000\",\"boardLotSize\":\"1000\",\"vcmEligible\":\"Y\",\"vcmStatus\":\"N\",\"vcmStarttime\":\"\",\"vcmEndtime\":\"\",\"vcmRefPrice\":\"\",\"vcmUpperLimitPrice\":\"\",\"vcmLowerLimitPrice\":\"\",\"casEligible\":\"Y\",\"casReferencePrice\":\"2.7100000\",\"casUpperLimitPrice\":\"2.8400000\",\"casLowerLimitPrice\":\"2.5800000\",\"asOfDateTime\":\"2021-08-17T16:08:06+0800\",\"posEligible\":\"Y\",\"posReferencePrice\":\"\",\"posBuyUpperPrice\":\"\",\"posBuyLowerPrice\":\"\",\"posSellUpperPrice\":\"\",\"posSellLowerPrice\":\"\",\"auctionType\":\" \",\"delay\":true},{\"symbol\":\"02800\",\"companyNameEN\":\"TRACKER FUND\",\"companyNameTC\":\"盈富基金\",\"companyNameSC\":\"盈富基金\",\"suspendedIndicator\":\"false\",\"sessionType\":\" \",\"nominalPrice\":\"26.7000000\",\"currency\":\"HKD\",\"changeAmount\":\"-1.1600000\",\"changePercent\":\"-4.1640\",\"dayHighPrice\":\"27.5000000\",\"dayLowPrice\":\"26.7000000\",\"spreadCode\":\"05\",\"preClosePrice\":\"27.8600000\",\"openPrice\":\"27.5000000\",\"volume\":\"304025928\",\"turnover\":\"8216446664.0000\",\"boardLotSize\":\"500\",\"vcmEligible\":\"N\",\"vcmStatus\":\"\",\"vcmStarttime\":\"\",\"vcmEndtime\":\"\",\"vcmRefPrice\":\"\",\"vcmUpperLimitPrice\":\"\",\"vcmLowerLimitPrice\":\"\",\"casEligible\":\"Y\",\"casReferencePrice\":\"26.7600000\",\"casUpperLimitPrice\":\"27.8600000\",\"casLowerLimitPrice\":\"26.6800000\",\"asOfDateTime\":\"2021-08-17T16:08:06+0800\",\"posEligible\":\"Y\",\"posReferencePrice\":\"\",\"posBuyUpperPrice\":\"\",\"posBuyLowerPrice\":\"\",\"posSellUpperPrice\":\"\",\"posSellLowerPrice\":\"\",\"auctionType\":\" \",\"delay\":true},{\"symbol\":\"00857\",\"companyNameEN\":\"PETROCHINA\",\"companyNameTC\":\"中國石油股份\",\"companyNameSC\":\"中国石油股份\",\"suspendedIndicator\":\"false\",\"sessionType\":\" \",\"nominalPrice\":\"3.2200000\",\"currency\":\"HKD\",\"changeAmount\":\"-0.0700000\",\"changePercent\":\"-2.1280\",\"dayHighPrice\":\"3.2800000\",\"dayLowPrice\":\"3.2100000\",\"spreadCode\":\"01\",\"preClosePrice\":\"3.2900000\",\"openPrice\":\"3.2700000\",\"volume\":\"100239506\",\"turnover\":\"324780909.0000\",\"boardLotSize\":\"2000\",\"vcmEligible\":\"Y\",\"vcmStatus\":\"N\",\"vcmStarttime\":\"\",\"vcmEndtime\":\"\",\"vcmRefPrice\":\"\",\"vcmUpperLimitPrice\":\"\",\"vcmLowerLimitPrice\":\"\",\"casEligible\":\"Y\",\"casReferencePrice\":\"3.2200000\",\"casUpperLimitPrice\":\"3.3800000\",\"casLowerLimitPrice\":\"3.0600000\",\"asOfDateTime\":\"2021-08-17T16:08:07+0800\",\"posEligible\":\"Y\",\"posReferencePrice\":\"\",\"posBuyUpperPrice\":\"\",\"posBuyLowerPrice\":\"\",\"posSellUpperPrice\":\"\",\"posSellLowerPrice\":\"\",\"auctionType\":\" \",\"delay\":true},{\"symbol\":\"01091\",\"companyNameEN\":\"SOUTH MANGANESE\",\"companyNameTC\":\"南方錳業\",\"companyNameSC\":\"南方锰业\",\"suspendedIndicator\":\"false\",\"sessionType\":\" \",\"nominalPrice\":\"1.0900000\",\"currency\":\"HKD\",\"changeAmount\":\"0.2400000\",\"changePercent\":\"28.2350\",\"dayHighPrice\":\"1.1300000\",\"dayLowPrice\":\"0.9000000\",\"spreadCode\":\"01\",\"preClosePrice\":\"0.8500000\",\"openPrice\":\"0.9000000\",\"volume\":\"231186559\",\"turnover\":\"240808084.0000\",\"boardLotSize\":\"1000\",\"vcmEligible\":\"N\",\"vcmStatus\":\"\",\"vcmStarttime\":\"\",\"vcmEndtime\":\"\",\"vcmRefPrice\":\"\",\"vcmUpperLimitPrice\":\"\",\"vcmLowerLimitPrice\":\"\",\"casEligible\":\"Y\",\"casReferencePrice\":\"1.0900000\",\"casUpperLimitPrice\":\"1.1200000\",\"casLowerLimitPrice\":\"1.0400000\",\"asOfDateTime\":\"2021-08-17T16:08:06+0800\",\"posEligible\":\"Y\",\"posReferencePrice\":\"\",\"posBuyUpperPrice\":\"\",\"posBuyLowerPrice\":\"\",\"posSellUpperPrice\":\"\",\"posSellLowerPrice\":\"\",\"auctionType\":\" \",\"delay\":true},{\"symbol\":\"00728\",\"companyNameEN\":\"CHINA TELECOM\",\"companyNameTC\":\"中國電信\",\"companyNameSC\":\"中国电信\",\"suspendedIndicator\":\"false\",\"sessionType\":\" \",\"nominalPrice\":\"2.9700000\",\"currency\":\"HKD\",\"changeAmount\":\"-0.1200000\",\"changePercent\":\"-3.8830\",\"dayHighPrice\":\"3.1500000\",\"dayLowPrice\":\"2.9500000\",\"spreadCode\":\"01\",\"preClosePrice\":\"3.0900000\",\"openPrice\":\"3.0600000\",\"volume\":\"175012917\",\"turnover\":\"532989438.0000\",\"boardLotSize\":\"2000\",\"vcmEligible\":\"Y\",\"vcmStatus\":\"N\",\"vcmStarttime\":\"\",\"vcmEndtime\":\"\",\"vcmRefPrice\":\"\",\"vcmUpperLimitPrice\":\"\",\"vcmLowerLimitPrice\":\"\",\"casEligible\":\"Y\",\"casReferencePrice\":\"2.9700000\",\"casUpperLimitPrice\":\"3.1100000\",\"casLowerLimitPrice\":\"2.8300000\",\"asOfDateTime\":\"2021-08-17T16:08:07+0800\",\"posEligible\":\"Y\",\"posReferencePrice\":\"\",\"posBuyUpperPrice\":\"\",\"posBuyLowerPrice\":\"\",\"posSellUpperPrice\":\"\",\"posSellLowerPrice\":\"\",\"auctionType\":\" \",\"delay\":true},{\"symbol\":\"08133\",\"companyNameEN\":\"JETE POWER\",\"companyNameTC\":\"鑄能控股\",\"companyNameSC\":\"铸能控股\",\"suspendedIndicator\":\"false\",\"sessionType\":\" \",\"nominalPrice\":\"0.0110000\",\"currency\":\"HKD\",\"changeAmount\":\"0.0000000\",\"changePercent\":\"0.0000\",\"dayHighPrice\":\"0.0110000\",\"dayLowPrice\":\"0.0100000\",\"spreadCode\":\"01\",\"preClosePrice\":\"0.0110000\",\"openPrice\":\"0.0100000\",\"volume\":\"36380000\",\"turnover\":\"369800.0000\",\"boardLotSize\":\"20000\",\"vcmEligible\":\"N\",\"vcmStatus\":\"\",\"vcmStarttime\":\"\",\"vcmEndtime\":\"\",\"vcmRefPrice\":\"\",\"vcmUpperLimitPrice\":\"\",\"vcmLowerLimitPrice\":\"\",\"casEligible\":\"Y\",\"casReferencePrice\":\"0.0110000\",\"casUpperLimitPrice\":\"0.0110000\",\"casLowerLimitPrice\":\"0.0110000\",\"asOfDateTime\":\"2021-08-17T16:08:03+0800\",\"posEligible\":\"Y\",\"posReferencePrice\":\"\",\"posBuyUpperPrice\":\"\",\"posBuyLowerPrice\":\"\",\"posSellUpperPrice\":\"\",\"posSellLowerPrice\":\"\",\"auctionType\":\" \",\"delay\":true},{\"symbol\":\"01288\",\"companyNameEN\":\"ABC\",\"companyNameTC\":\"農業銀行\",\"companyNameSC\":\"农业银行\",\"suspendedIndicator\":\"false\",\"sessionType\":\" \",\"nominalPrice\":\"2.6100000\",\"currency\":\"HKD\",\"changeAmount\":\"-0.0100000\",\"changePercent\":\"-0.3820\",\"dayHighPrice\":\"2.6300000\",\"dayLowPrice\":\"2.5900000\",\"spreadCode\":\"01\",\"preClosePrice\":\"2.6200000\",\"openPrice\":\"2.6200000\",\"volume\":\"123946417\",\"turnover\":\"322981188.0000\",\"boardLotSize\":\"1000\",\"vcmEligible\":\"Y\",\"vcmStatus\":\"N\",\"vcmStarttime\":\"\",\"vcmEndtime\":\"\",\"vcmRefPrice\":\"\",\"vcmUpperLimitPrice\":\"\",\"vcmLowerLimitPrice\":\"\",\"casEligible\":\"Y\",\"casReferencePrice\":\"2.6200000\",\"casUpperLimitPrice\":\"2.7500000\",\"casLowerLimitPrice\":\"2.4900000\",\"asOfDateTime\":\"2021-08-17T16:08:04+0800\",\"posEligible\":\"Y\",\"posReferencePrice\":\"\",\"posBuyUpperPrice\":\"\",\"posBuyLowerPrice\":\"\",\"posSellUpperPrice\":\"\",\"posSellLowerPrice\":\"\",\"auctionType\":\" \",\"delay\":true},{\"symbol\":\"00762\",\"companyNameEN\":\"CHINA UNICOM\",\"companyNameTC\":\"中國聯通\",\"companyNameSC\":\"中国联通\",\"suspendedIndicator\":\"false\",\"sessionType\":\" \",\"nominalPrice\":\"4.2100000\",\"currency\":\"HKD\",\"changeAmount\":\"-0.0800000\",\"changePercent\":\"-1.8650\",\"dayHighPrice\":\"4.3200000\",\"dayLowPrice\":\"4.1700000\",\"spreadCode\":\"01\",\"preClosePrice\":\"4.2900000\",\"openPrice\":\"4.2600000\",\"volume\":\"72857816\",\"turnover\":\"309163488.0000\",\"boardLotSize\":\"2000\",\"vcmEligible\":\"Y\",\"vcmStatus\":\"N\",\"vcmStarttime\":\"\",\"vcmEndtime\":\"\",\"vcmRefPrice\":\"\",\"vcmUpperLimitPrice\":\"\",\"vcmLowerLimitPrice\":\"\",\"casEligible\":\"Y\",\"casReferencePrice\":\"4.2000000\",\"casUpperLimitPrice\":\"4.3200000\",\"casLowerLimitPrice\":\"4.0200000\",\"asOfDateTime\":\"2021-08-17T16:08:03+0800\",\"posEligible\":\"Y\",\"posReferencePrice\":\"\",\"posBuyUpperPrice\":\"\",\"posBuyLowerPrice\":\"\",\"posSellUpperPrice\":\"\",\"posSellLowerPrice\":\"\",\"auctionType\":\" \",\"delay\":true}]}";
            when(httpClientHelper.doGet(any(String.class),any(String.class),any(HashMap.class))).thenReturn(httpResult3);
            Map<String,String> serviceRequestMapper =(Map<String,String>)topMoverMidfsService.convertRequest(topMoverRequest,commonRequestHeader);
            Map<String, String> serviceResponseMapper =(Map<String, String>) topMoverMidfsService.execute(serviceRequestMapper);
            Object response =  topMoverMidfsService.validateServiceResponse(serviceResponseMapper);
            assertNotNull(response);
        }catch (Exception e){
            e.printStackTrace();
        }
    }

    @Test
    public void testConvertResponse() throws Exception{
        Map<String,String> serviceRequestMapper =(Map<String,String>)topMoverMidfsService.convertRequest(topMoverRequest,commonRequestHeader);
        Map<String, String> serviceResponseMapper =(Map<String, String>) topMoverMidfsService.execute(serviceRequestMapper);
        Object validateServiceResponse = topMoverMidfsService.validateServiceResponse(serviceResponseMapper);
        TopMoverLabciResponse topMoverLabciResponse = topMoverMidfsService.convertResponse(validateServiceResponse);
        assertNotNull(topMoverLabciResponse);
        for (TopMoverLabciTable table : topMoverLabciResponse.getTopMovers()){
            assertEquals("MAIN",table.getBoardType());
        }
    }
    @Test
    public void testLocalConvertResponse() throws Exception{
        commonRequestHeader.setLocale("zh_CN");
        Map<String,String> serviceRequestMapper =(Map<String,String>)topMoverMidfsService.convertRequest(topMoverRequest,commonRequestHeader);
        Map<String, String> serviceResponseMapper =(Map<String, String>) topMoverMidfsService.execute(serviceRequestMapper);
        Object validateServiceResponse = topMoverMidfsService.validateServiceResponse(serviceResponseMapper);
        TopMoverLabciResponse topMoverLabciResponse = topMoverMidfsService.convertResponse(validateServiceResponse);
        assertNotNull(topMoverLabciResponse);
        for (TopMoverLabciTable table : topMoverLabciResponse.getTopMovers()){
            assertEquals("MAIN",table.getBoardType());
        }
    }

    @Test
    public void testLocal2ConvertResponse() throws Exception{
        commonRequestHeader.setLocale("zh_HK");
        Map<String,String> serviceRequestMapper =(Map<String,String>)topMoverMidfsService.convertRequest(topMoverRequest,commonRequestHeader);
        Map<String, String> serviceResponseMapper =(Map<String, String>) topMoverMidfsService.execute(serviceRequestMapper);
        Object validateServiceResponse = topMoverMidfsService.validateServiceResponse(serviceResponseMapper);
        TopMoverLabciResponse topMoverLabciResponse = topMoverMidfsService.convertResponse(validateServiceResponse);
        assertNotNull(topMoverLabciResponse);
        for (TopMoverLabciTable table : topMoverLabciResponse.getTopMovers()){
            assertEquals("MAIN",table.getBoardType());
        }
    }

}
